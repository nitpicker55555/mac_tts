# Toast Talk - AI 语音对话助手

一个基于 macOS 的实时语音对话应用，使用 OpenAI GPT-4o 和苹果原生语音识别技术。

## 功能特点

- 🎙️ 实时中文语音转文字（流式输出）
- 🤖 OpenAI GPT-4o 智能对话（流式响应）
- 🔊 多种中文语音选择（系统自带）
- 🎨 优雅的 Toast 风格界面
- ⚡ 自动检测说话结束
- 🎵 可调节语速和音量
- 🛠️ AI工具集成
  - 🚊 交通路线搜索（支持公共交通）
  - 🗺️ 路线地图可视化
- 💻 代码执行功能
- 📝 对话日志记录

## 配置说明

1. **创建配置文件**
   在 `toast_talk` 文件夹中创建 `Config.swift`：
   ```swift
   import Foundation

   struct Config {
       // OpenAI API 配置
       static let openAIAPIKey = "你的-API-密钥"
       static let openAIModel = "gpt-4o"
       
       // 其他配置项
       static let speechRecognitionLocale = "zh-CN"
       static let defaultSpeechRate: Float = 0.5
       static let silenceThreshold: TimeInterval = 1.5
   }
   ```

2. **添加到 Xcode 项目**
   - 右键点击 Xcode 中的 `toast_talk` 文件夹
   - 选择 "Add Files to toast_talk..."
   - 选择 `Config.swift` 并添加

3. **确保安全**
   `Config.swift` 已添加到 `.gitignore`，不会被提交到版本控制

## 系统要求

- macOS 13.0+
- Xcode 14.0+
- OpenAI API 密钥

## 使用方法

1. 打开项目并配置 API 密钥
2. 在 Xcode 中运行项目
3. 点击"说话"按钮开始录音
4. 说完后停顿 1.5 秒会自动停止
5. AI 会流式返回回复并语音播放

### 交通路线搜索功能

AI助手现在支持搜索公共交通路线，并能识别特殊位置：

**预定义位置：**
- 家：48.107662, 11.5338275
- 学校/大学：48.1493705, 11.5690651

**示例对话：**
- "帮我查一下从当前位置到学校的路线"
- "从家到慕尼黑中央车站怎么走"
- "搜索从我的位置到家的公交路线"
- "从学校到慕尼黑机场的路线"
- "搜索从经纬度48.1351,11.5820到48.1077,11.5338的公交路线"

当AI搜索到路线后：
1. 会显示详细的路线信息（包含每个班次的具体时间）
2. 地图按钮会亮起，点击可查看路线地图
3. 增强版地图功能：
   - 显示最多3个路线方案，可通过标签切换
   - 不同交通工具使用不同颜色（公交-蓝色、地铁-紫色、步行-灰色虚线等）
   - 显示每个站点的到达/出发时间
   - 显示总行程时间和详细时刻表

**注意：** 当前使用德国公共交通API，主要支持德国地区的交通查询

## 语音设置

点击扬声器图标可以：
- 选择不同的中文语音（婷婷、雨舒、甜甜等）
- 调节语速（0.1-1.0）
- 调节音量（0.1-1.0）

## 隐私权限

应用需要以下权限：
- 麦克风：用于语音输入
- 语音识别：用于语音转文字
- 位置：用于基于当前位置的路线导航（可选）
- 网络：用于调用 OpenAI API 和交通路线API